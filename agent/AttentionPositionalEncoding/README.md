

```python
import random
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

import os

import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim

from custom_trading_env import TradingEnv
from utils import device
import DQNTradingAgent.dqn_agent as dqn_agent
from custom_hyperparameters import hyperparams
from arguments import argparser
```


```python
class args:
    def __init__(self,):
        self.device_num = 2
        self.save_num = 1
        self.risk_aversion = 1.
        self.n_episodes = 3000
        self.fee = .001

args = args()
device = torch.device("cuda:{}".format(args.device_num))
dqn_agent.set_device(device)

save_location = 'saves/{}'.format(args.save_num)

if not os.path.exists(save_location):
    os.makedirs(save_location)

save_interval  = 200
print_interval = 1

n_episodes   = args.n_episodes
sample_len   = 480
obs_data_len = 192
step_len     = 1
fee          = args.fee
sell_at_end  = False

risk_aversion_multiplier = 0.5 + args.risk_aversion / 2

n_action_intervals = 5

init_budget = 1

torch.save(hyperparams, os.path.join(save_location, "hyperparams.pth"))

df = pd.read_hdf('dataset/binance_data_train.h5', 'STW')
df.fillna(method='ffill', inplace=True)
```


```python
env = TradingEnv(custom_args=args, env_id='custom_trading_env', obs_data_len=obs_data_len, step_len=step_len, sample_len=sample_len,
                 df=df, fee=fee, initial_budget=1, n_action_intervals=n_action_intervals, deal_col_name='c',
                 sell_at_end=sell_at_end,
                 feature_names=['o', 'h','l','c','v',
                                'num_trades', 'taker_base_vol'])
agent = dqn_agent.Agent(action_size=2 * n_action_intervals + 1, obs_len=obs_data_len, num_features=env.reset().shape[-1], **hyperparams)
```

    [2019-08-05 14:09:10,995] Making new env: custom_trading_env
    /home/jeffrey/Binanace_trading_simulation/agent/Attention/custom_trading_env.py:99: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.
      self.price = self.df_sample[self.price_name].as_matrix()
    /home/jeffrey/Binanace_trading_simulation/agent/Attention/custom_trading_env.py:101: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.
      self.obs_features = self.df_sample[self.using_feature].as_matrix()



```python
beta = 0.4
beta_inc = (1 - beta) / 1000
agent.beta = beta

scores_list = []
loss_list = []
n_epi = 0
# for n_epi in range(10000):  # 게임 1만판 진행
for i_episode in range(n_episodes):
    n_epi +=1

    if (i_episode + 1) % 500 == 0:
        sample_len += 480
        env.sample_len = sample_len

    state = env.reset()
    score = 0.
    actions = []
    rewards = []

    # for t in range(num_steps):
    while True:
        action = int(agent.act(state, eps=0.))
        next_state, reward, done, _ = env.step(action)

        rewards.append(reward)
        score += reward
        if reward < 0:
            reward *= risk_aversion_multiplier
        if sell_at_end and done:
            action = 2 * n_action_intervals
        actions.append(action)
        agent.step(state, action, reward, next_state, done)
        state = next_state
        if done:
            break
    else:
        agent.memory.reset_multisteps()

    beta = min(1, beta + beta_inc)
    agent.beta = beta

    scores_list.append(score)

    if n_epi % print_interval == 0 and n_epi != 0:
        print_str = "# of episode: {:d}, avg score: {:.4f}\n  Actions: {}".format(n_epi, sum(scores_list[-print_interval:]) / print_interval, np.array(actions))
        print(print_str)
        # with open(os.path.join(save_location, "output_log.txt"), mode='a') as f:
        #     f.write(print_str + '\n')

    if n_epi % save_interval == 0:
        torch.save(agent.qnetwork_local.state_dict(), os.path.join(save_location, 'TradingGym_Rainbow_{:d}.pth'.format(n_epi)))
        torch.save(scores_list, os.path.join(save_location, 'scores.pth'))

del env

```

    # of episode: 1, avg score: -0.0432
      Actions: [ 2  2  4  2  4  4  4  2  2  6  5  2  2  4  2  2  5  4  4  2  2  2  2  2
      5  4  4  5  2  4  5  6  9  5  4  4  2  2  0  5  2  4  4  4  2  4  2  2
      2  2  2  6  2  5  2  5  2  7  9  3 10  2  2  4  6  2  2  4  4  6  2  5
      8  2  4  9  5  2  4  6  5  4  2  2  2  2  2  4  2  4  2  9  2  4  2  5
      2  2  0  6  2  2  4  9  5  4  5  2  5  2  5  2  4  2  0  7  4  3  2  2
      7  2  2  4  4  2  2  4  4  6 10  2  4  4  4  4  2  2  4  7  2  2  2  4
      2  5  2  4  4  2  2  2  2  2  2 10  4  2 10  2  2  2  2  2  2  5  5  2
      2  4  7  4  2  2  4  9  5  4  4  2  2  2  4  4  5  2  4  2  4  4  2  4
      7  2  4  2  1  2  4  2  2  2  3  0  2  2  2  7  4  9  2  2  9  6  0  2
      2  5  2  4  5  2  2  3  0  3  2  5  2  2  4  5  4  4  2  4  2  1  0  2
      5  2  4  2  4  2 10  4  0  2  2  5  2  9  2  2  2  2  2  2  4  4  4  2
      2  5  1  2  5  4  2  2  1  2  2  4  2  4  2  2  2  6  4  2  1  5  4]
    # of episode: 2, avg score: -0.1308
      Actions: [ 2  2  4  5  4  2  2  2  4  2  7  2  9  5  2  7  7  2  6  2  2  5  2  2
      0  2  4  4  5  4  4  2  2  4  9  2  2  7  2  4  2  1  5  2  4  4  4  4
      3  2  2  2  2  2  5  2  0  2  2  2  2  2  4  4  2  2  4  3  4  0  2  2
      5  4  4  7  4  5  2  7  6  4  2  2  2  3  4  0  2  4  2  5  2  2  7  2
      6  4  4  2  2  4  2  2  2  2  2  2  5  2  9  7  2  4  4  2  2  2  2  4
      2  4  2  2  2  2  4  2  2  4  2  2  2  4  2  9  9  2  0  2  2  2  2  4
      5  9  2  4  4  4  2  2  2  2  2  2  4  4  5  2  4  2  2  4  2  2  2  4
      2  2  2  0  2  5  4  2  4  4  9  0  2  2  2  4  4  2  5  4  2  4  1  2
      2  5  5  2  2  4  9  9  4  5  2  2  4  2  2  9  5  2  2 10  4  2  9  5
      5  2  2  2  2  2  5  5  4  9  2  2  2  2  2  2  4  2  9  2  0  2 10  2
      2  2  4  2  2  2  2  1  2  9  5  0  4  2  2  2  4  4  5  4  4  4  4  2
      4  2  5  2  2  2  2  4  2  2  9  0  4  2  2  2  9  5  2  5  2  6  2]
    # of episode: 3, avg score: -0.0229
      Actions: [ 2  4  2  5  5  1  2  2  2  2  2  2  2  2  6  4  9  2  2  4  0  5  2  2
      2  2  2  4  4  2  5  2  5  4  2  5  2  6 10  2  4  2  4  5  2  2  2  9
      7  5  2  2  4  2  2  5  2  4  2  2  2  2  4  2  4  2  2  4  4  2  7  2
      9  2  9  6  5  2  4  4  0  5  6  2  2  2  4  2  4  2  2  2  4  2  2  2
      4  2  2  2  4  2  2  2  4  4  2  9  4  2  4  9  2  4  7  4  4  2  2  4
      9  4  2  2  2  2  2  2  4  9  4  5  2  4  4  2  4  4  2  4  2  4  2  2
      2  0  9  4  6  4  7  2  2  4  4  2  4  4  2  5  9  2  4  2  5  2  7  6
      2  2  5  2  0  2  4  4  4  4  2  5  4  4  4  5  2  2  5  6  2  4  4  2
      0  4  6  4  4  4  5  2  2  4  2  2  2  4  2  4  4  4  5  2  2  4  2  2
      2  2  5  4  4  4  5  2  2  4  4  2  4  2  2  4  9  5  2  5  9  4  3  2
      4  2  4  5  4  4  2  2  1  2  4  9  0  2  4  4  4  2  2  4  5  1  5  6
      4  4  2  4  4  9  6  6  2  6  4  2  2  5  7  2  2  2  4  4  4  2  2]
    # of episode: 4, avg score: -0.0640
      Actions: [ 9  2  4  5  4  2  2  2  2  2  5  2  2  4  4  2  5  2  2  2  2  4  4  2
      4  2  2  2  2  2  2  2  6  0  5  2  4  2  2  2  2  9  2  2  4  4  2  5
      3  4  6  4  2  4  2  3  2  2  4  2  4  2  5  2  9  2  0  2  3  2  2  4
      2  2  4  2  5  9  2  2  4  2  6  2  4  4  2  5  2  1  2  2  4  4  5  2
      2  2  2  5  4  4  6  2  4  2  5  4  2  2  2  2  2  2  3  4  5  2  5  4
      2  2  4  4  4  4  3  5  5  4  2  5  4  9  4  4  5  2  4  4  5  9  2  6
      4  4  4  2  9  2  2  5  4  2  4  4  2  2  4  2  2  2  4  2  2  2  2  4
      2  4  4  1  2  4  2  2  2  7  2  2  4  4  2  2  2  2  2  2  4  5  2  2
      2  2  4  2  2  2  4  5  6  4  2  4  2  9  2  2  5  9  2  4  4  2  2  4
      7  0  6 10  2  4  2  2  4  4  2  2  2  4  4  2  2  4  2  4  4  5  4  4
      9  2  2  2  5  4  2  4  4  4  4  2  2  2  4  4  2  4  2  5  2  4  2  0
      4  2  4 10  2  6  2  4  4  6  4  2  2  2  9  2  5  6  6  9  2  4  2]
    # of episode: 5, avg score: -0.0429
      Actions: [ 9  2  2  2  4  2  2  4  2  2  2  0  2  2  5  2  6  4  9  0  2  2  4  5
      5  2  2  4  6  2  2  4  4  7  2  6  5  4  2  5  2  4  4  2  4  4  2  4
     10  2  3  4  2  4  2  0  2  2  2  5  5  2  2  2  3  4  9  4  2  2  2  4
      5  2  2  4  2  4  2  2  5  2  2  2  4  2  4  4  4  4  2  2  4  4  4  2
      2  4  2  2  4  2  2  2  4  2  4  2  2  2  2  2  2  2  3  7  4  2  2  5
      2  4  5  2  2  5  4  2  5  2  4  2  2  4  2  6  2  5  1  2  9  4  2  4
      5  4  2  4  0  2  2  4  2  4 10  2  4  2  4  2  2  4  2  4  2  2  2  4
      9  5  7  5  2  4  2  2  4  2  5  9  4  2  4  5  2  2  4  4  2  4  2  2
      2  4  5  2  4  4  5  4  9  4  2  5  6  5  2  2  2  7 10  6  4  4  2  2
      4  2  2  4  2  9  5  2  2  4  4  6  4  4  4  5  2  5  2  2  2  4  7  4
      5  7  2  2  2  2  4  9  2  2  2  2  7  4  4  4  4  2  5  2  6  2  2  0
      2  4  5  6  2  2  4  2  1  2  2  4  7  2  2  4  2 10  4  4  2  2  4]
    # of episode: 6, avg score: -0.1357
      Actions: [ 2  2  2  2  2  4  2  4  4  2  4  4  2  2  4  3  4  2  2  2  6  4  2  6
      4  2  5  4  4  4  2  4  4  2  4  5  4  2 10  4  9  4  2  4  5  2  4  6
      5  6  2  2  2  4  4  2  2  2  2  5  4  7  4  4  2  4  6  2  2  2  2  2
      4  2  4  1  2  6  2  2  2  2  9  4  4  2  2  7  2  3  4  2  7  2  4  2
      2  4  2  4  2  5  9  2  4  4  4  2  2  4  2  2  2  4  2  4  2  2  2  2
      2  4  5  2  5  2  2  4  2  6  4  2  4  5  2  7  4  4  4  2  4  4  2  4
      2  0  9  2  4  2  2  4  2  4  4  2  4  2 10  4  2  6  4  4  4  2  5  6
      2  4  5  4  5  4  2  2  4  4  4  2  2  2  5  2  0  2  2  2  4  4  2  4
      2  2  2  2  2  5  4  2  2  2  4  2  4  2  2  4  4  2  2  2  4  2  5  2
      5  2  4  2  2  4  5  2  5  2  2  5  2  4  2  2  2  2  2  2  4  4  2  3
      6  2  4  2  2  5 10  2  4  0  4  2  2 10  2  2  5  0  5  9  4  4  2  4
      4  2  5  2  4  4  2  2  6  2  2  2  2  4  9  2  4  4  4  2  5  4  4]
    # of episode: 7, avg score: -0.0385
      Actions: [ 4  9  2  4  7  2  4  9  2  4  2  4  6  2  2  2  2  5  1  2  4  4  2  2
      2  4  2  9  2  2  2  3  5  2  2  2  4  2  2  4  4  4  7  2  2  4  2  2
      4  2  2  4 10  2  4  2  5  2  2  9  2  2  2  9  2  6  5  2  2  1  2  2
      4  5  2  2  0  2  4  4  2  2  2  2  4  5  3  2  2  4  1  2  4  4  2  5
      2  6  2  4  4  2  5  4  5  4  4  4  2 10  5  6  7  4  4  6  6  2  4  2
      2  5 10  4  2  2  2  2  4  4  2  4  2  2  2  3  4  4  2  4  2  4  2  5
      4  0  2  4  2  2  4  4  4  2  2  2  4  2  2  5  2  2  4  2  2  9  4  2
      4  2  2  5  0  2  2  5  2  5  2  5  2  0  2  4  2  0  4  4  2  9  2  6
      4  4  4  9  4  4  2  7  4  5  4  2  2  9  2  2  4  2  2  5  2  3  0  2
      2  2  4  2  2  2  2  4  4  2  6  5  2  2  2  4  5  7  2  5  4 10  4  4
      5  2  2  2  4  2  9  4  0  2  2  4  2  2  4  2  2  2  2  2  5  2  4  4
      2  2  5  2  2  7  2  2  4  2  2  2  4  4  0  0  4  0  4  4  4  2  2]
    # of episode: 8, avg score: -0.0391
      Actions: [10  0  2  4  2  2  0  5  5  5  4  9  6  4  4  2  2  2  4  2  5  4  2  9
      2  4  5  5  4  2  4  4  2  2  2  5  5  5  4  4  4  4  2  2  4  2  5  4
      6  4  5  4  2  2  2  2  5  4  2  2  4  4  2  2  2  4  2  5  2  4  4  5
      4  2  2  2  2  4  4  4  6  0  4  2  2  2  2  2  2  2  4  5  4  2  4  5
      1  2  2  5  2  5  4  5  0  2  4  9  4  2  5  9  4  7  5  2  6  2  2  2
      7  5  2  2  4  2  2  7  2  3  5  4  4  2  4  4  2  5  2  5  2  1  9  2
      2  0  4  2  2  2  2  5  4  4  5  2  2 10  2  2  5  2  2  2  2  3  4  4
      2  4  4  5  2  4  0  4  5  4  4  4  5  2  2  4  4  5  4  2  2  4  2  4
      2  4  2  2  2  2  2  6  2  2  2  2  4  9  2  2  5  2  2  2  2  2  4  9
      2  2  5  2  2  4  2  2  2  4  9  2  2  2  2  9  9  6  2  3  0  2  2  4
      2  4  2  2  4  4  0  2  2  2  4  2  4  7  2  4  2  2  4  2  2  2  5  2
     10  2  2  4  4  5  2  2  5  4  0  2  4  2  2  2  5  2  9  0  4  2  5]
    # of episode: 9, avg score: 0.2039
      Actions: [ 2  4  2  4  2  2  3  6  2  5  4  4  9  2  5  2  7  4  4  4  2  5  6  4
      6  4  2  5  2  2  2  2  5  4  2  4  6  4  2  2  4  2  2  4  2  4  5  4
      4  5  5  2  2  4  7  2  6  2  2  2  5  4  5  7  6  2  2  5  2  4  2  2
      4  2  4  6  4  2  6  5  4  2  5  9  4  6  5  4  5  1  2  2  4  2  2  4
      2  4  2  4  2  4  2  4  4  2  2  4  4  0  2  2  2  5  4  4  4  5  5  9
      2  4  5  0  2  2  2  2  2  4  4  4  2  0  4  2  2  2  2  7  2  2  2  5
      4  5  2  5  4  5  2  4  4  4  2  2  6  4  4  6  2  4  9  2  2  4  2  4
      2  4  2  5  2  4  2  2  2  7  4  5  2  4  2  2  4  2  9  4  4  9  2  2
      4  2  4  6  2  2  4  4  2  2  2  9  9  2  2  2  6  2  2 10  4  2  4  9
      2  5  2  4  4  2  2  9  9  5  4  2  2  4  5  2  2  4  4  2  2  2  2  2
      2  4  5  2  9  4  2  4  2  2  2  4  2  4  5  2  4  2  4  4  9  2  4  2
      2  6  2  2  3  5  6  4  2  2  5  5  2  2  2  3  5  5  4  4  2  1  2]
    # of episode: 10, avg score: 0.0413
      Actions: [ 4  4  2  9  4  2  2  2  4  4  5  2  6  2  4  5  9  2  2  2  2  4  2  2
      5  5  9  2  2  2  0  0  4  6  4  4  5  2  2  2 10  2  4  4  4  5  5  9
      4  2  4  7  4  4  2  2  0  2  5  2  0  0  2  2  2  2  2  2  6  2  4  2
      2  9  4  4  2  5  2  4  2  2  4  4  4  2  9  2  2  2  2  2  4  9  2  2
      4  4  2  2  2  2  5  4  2  2  4  2  5  6  0  2  4  2  2  2  9  9  2  2
      2  2  7  2  4  5  5  4  2  2  4  9  2  2  4  3  4  0  2  2  2  4  2  2
      2  2  2  4  2  7  5  5  4  2  7  5  0  2  4  2  4  3  5  0  2  2  2  4
      2  4  2  4  5  6  4  2  4  4  5  4  9  4  4  3  2  2  2  4  4  5  2  2
      7  2  2  2  2  2  4  6  7  2  5  2  2  2  2  4  4  5  4  4  2  2  4  0
      4  2  2  2  9  2  2  2  5  2  2  2  4  9  4  2  2  2  4  7  2  4  4  2
      2  0  2  4  2  2  4  3  2  2  2  2  5  3  6  2  9  5  4  4  5  2  2  4
      7  2  5  2  2  2  4  4  2 10  2  4  2  2  4  2  4  2  4  4  4  2  2]
    # of episode: 11, avg score: -0.0589
      Actions: [ 4  4  2  2  5  4  2  2  2  2  5  4  2  9  2 10  4  2  2  4  4  4  2  4
      2  2  2  2  0  2  4  2  5  2  7  2  2  4  4  6  4  4  5  2  2  4  2  2
      7  2  5  4  2  2  2  2  2  5  2  2 10  5  2  4  4  2  2  4  4  2  0  4
      5  4  5  2  2  4  2  5  6  4  2  2  2  2  2  4  2  2  2  4  6  2  4  4
      5  5  2  2  2  2 10  4  2  2  4  4  2  2  4  4  2  5  4  5  2  2  4  2
      6  4  2  4  2  6  4  4  2  4  2  2  0  2  2  2  2  6  2  4  4  4  4  4
      4  2  5  2  2  5  4  2  6  4  4  2  2  2  2  2  4  4  4  4  2  4  4  4
      4  2  2  2 10  4  2  4  4  2  2  2  2  5  4  2  5  4  7  5  2  2  2  2
      2  2  9  9  2  2 10  4  6  2  5  2  2  2  2  9  2  4  6  5  9  4  2  2
      2  2  2 10  4  5  2  2  2  2  5  2  9  5  2  4  2  2  9  2  2  9  2  2
      6  4  4  4  2  2  4  0  9  2  4  4  4  4  4  9  9  4  2  4  4  2  5  2
      5  5  4  2  2  2  4  5  2  2  4  4  4  4  2  4  9  9  2  5  2  2  2]
    # of episode: 12, avg score: -0.0950
      Actions: [10  2  2  2  4  2 10  4  2  2  5  2  2  4  2  6  2  2  4  9  7  2  4  7
      4  2  2  5  4  4  3  4  4  2  4  2  2  9  9  2  4  2  9  3  6  5  2  2
      4  4  4  4  3  4  4  2  4  5  4  4  4  2  0  2  2  2  2  2  4  2  6  4
      2  7  4  3  5  4  4  4  5  4  4  6  2  2  2  2  2  6  4  2  2  6  4  7
      2  3  2  2  4  2  2  6  2  4  6  4  2  2  4  2  5  9  4  4  2  2  7  2
      2  4  2  2  2  2  4  4  2  2  2  2  2  4  4  2  2  6  4  4  5  4  5  2
      2  4  2  2  2  4  7  2  2  2  2  2  4  2  2  5  5  5  4  2  2  4  2  2
      9  2  5  4  2  2  4  2  2  4  2  4  2  4  4  4  2  2  2  5  2  2  2  4
      2  2  2 10  4  4  2  4  2  2  9  9  3  4  2  2  2  2  6  9  4  2  2  5
      2  2  4  2  4  2  4  4  2  2  4  2  4  4  2  2  4  2  2  4  5  2  0  2
      2  2  2  7  2  2  2  2  4  2  5  2  9  4  2  7  5  4  2  2  6  2  2  4
      9  5  2  2  2  2  6  4  9  4  2  4  2  4  2  3  4  2  2  4  2  4  2]
    # of episode: 13, avg score: -0.0409
      Actions: [ 2  4  2  5  4  2  2  3  2  2  2  2  2  5  2  4  5  2  2  2  4  4  2  4
      0  2  5  4  5  2  0  2  2  2  2  4  4  4  4  2  2  2  4  2  5  2  2  6
      4  2  2  4  2  2  6  4  4  2  4  2  4  5  4  2  4  2  3  2  4  2  4  2
      4  9  5  2  4  4  4  2  2  5  4  2  2  5  2  2  2  4  9  4  2  9  4  4
      4  2  2  2  2  1  6  2  4 10  2  2  2  2  2  4  4 10  4  2  2  5  4  2
      2  2  2  4  7  2  2  4  4  4  5  2  0  2  2  4  3  2  2  2 10  4  9  2
      2  2  4  4  2  2  7  4  2  2  5  2  4  6  2  2  2  4  4  4  2  2  5  4
      9  7  4  2  4  4  5  2  2  6  2  2  2  2  4  2  2  2  4  9  3  2  2  4
      2  9  4  2  4  2  5  4  2  2  5  2  2  2  4  2  3  4  4  2  2  2  2  2
      4  5  2  4  2  2  4  2  2 10  2  4  2  4  4  2  4  2  2 10  2  2  2  2
      2  2  4  2  4  2  4  2  4  4  1  2  2  4  2  4  2 10  4  4  2  4  2  5
      5  2  2  2  2  2  2  2  9  2  4  2  2  4  2  2  4  2  2  4  5  4  2]
    # of episode: 14, avg score: -0.0556
      Actions: [ 4  4  6  4  4  9  2  4 10  4  6  2  2  2  2  2  2  2  7  4  5  6  2  2
      4  4  2  4  2  6  2  4  6  2  2  5  2  2  2  4  2  2  4  4  5  2  6  4
      4  2  2  4  2  2  2  4  5  4  2  2  0  2  4  2  2  2  6  2  6  2  2  5
      2  4  4  2  7  6  4  2  2  4  2  2  6  2  2  2  2  2  4  3  5  4  2  2
      2  5  2  7  9  4  2  2  2  2  2  2  2  4  7  4  2  5  2  4  4  2  2  2
      2  4  0  4  5  2  2  7  2  2  2  2  2  2  4  2  2  2  6  4  4  4  4  4
      4  2  2  2  2  4  2  4  4  6  4  4  2  2  4  2  4  4  4  2  4  2  4  4
      4  2  0  2  4  2  4  4  2  4  7  9  2  2  4  4  4  4  4  6  2  4  2  5
      4  2  2  2  4  9  2  2  2  2  2  9  2  2  5  2  7  2  4  4  4  2  2  6
      5  4  2  4  2  6  5  5  6  2  2  2  4  5  2  2  2  6  4  4  6  6  2  4
      4  2  4  2  2  2  0  2  5  2  1  2  2  5  2  2  2  6  4  5  5  5  4  2
      9  4  2  4  2  4  4  2  4  4 10  2  2  7  2  2  4  2  2  2  2  2  2]
    # of episode: 15, avg score: -0.0282
      Actions: [ 2  4  5  4  5  4  4  2  2  2  4  4  5  2  2  2  2  2  4  2  4  6  2  6
      5  2  4  2  2  2  4  5  5  2  5  4  4  2  5  4  2  5  0  2  2  4  2  9
      2  4  2  2  2  4  4  4  2  2  2  2  4  2  2  2  9  5  4  9  4  5  5  2
      2  2  2  4  2  2  5  2  2  9  4  5  5  4  2  2  2  7  2  4  2  2  4  6
      2  4  7  2  2  3  2  2  2  2  6  5  2  2  0  2  2  2  2  9  2  3  2  4
      2  4  2  2  5  4  2  2  4  2  2  5  6  4  2  2  2 10  2  5  2  9  2  9
      2  2  2  2  1  3  2  2  4  2  2  2  2  2  4  2  2  2  2  4  2  2  2  2
      2  2  2  2  0  9  5  2  2  2  2  2  2  9  5  4  2  2  3  9  9  5  9  2
      5  2  2  2  2  2  2  9  5  2  2  4  4  2  2  2  2  2  2  2  5  2  2  2
      2  2  4  3  2  5  2  2  2  5  2  2  2  9  4  2  2  0  2  2  1  5  2  2
      9  2  2  2  2  2  2  9  4  2  4  2  2  2  3  2  2  2  2  6  2  2  4  2
      2  4  3  2  2  2  4  2  2  6  2  2  5  2  2  2  2  5  4  5  2  2  4]
    # of episode: 16, avg score: -0.0437
      Actions: [ 4  2  4  4  4  4  5  4  4  2  2  2  2  2  2  5  0  4  4  2  2  6  5  4
      2  2  2  5  2  2  4  2  4  4  5  5  4  9  2  5  9  9  4  2  5  2  4  2
      4  2  2  2  2  4  4  2  3  2  2  2  4  2  4  2  2 10  4  2  2  4  2  2
      5  2  4  2  2  4  5  2  5  2  2  2  2  2  4  2  2 10  2  5  2  4  7 10
      4  2  9  4  2  0  6  2  4  5  2  4  5  2  2  5  2  2  6  2  4  2  4  4
      6  2  2  4  4  5  4  2  4  9  4  3  4  4  4  4  9  4  4  4  2  4  5  4
      2  5  4  2  4  5  4  2  6  2  2  2  2  4  2  2  4  2  3  2  4  5  2  0
      5  2  4  2  0  5  2  7  2  2  4  2  2  0  2  4 10  4  2  4  2  4  4  4
      2  2  2  4  2  4  2  4  9  9  5  2  4  5  5  4  4  2  2  5  2  4  0  2
      2  2  5  2  4  2  2  5  4  4  7  4  2  2  9  9  9  3  2  2  2  4  2  5
      2  2  2  9  2  2  2  2  2  2  2  3  2  4  5  5  4  0  5  4  2  2  4  9
      2  5  4  7  4  5  2  9  2  2 10  6  7  2  6  5  4  2  2  4  2  2  3]
    # of episode: 17, avg score: 0.6101
      Actions: [ 2  4  4  2  2  4  2  2  4  1  4  6  6  2  2  2  2  2  5  2  2  4  4  5
      2  2  2  2  2  2  2  2  4  4  4  2  2  4  4  2  9  5  4  5  7  2  4  6
      9  4  4  4  4  0  4  5  2  2  4  2  2  2  2  4  4  2  2  4  4  2  2  2
      7  4  5  4  4  9  4  5  2  9  4 10  2  4  4  2  4  2  2  2  4  4  4  2
      2  9  2  2  2  2  2  2  4  2  5  4  2  2  5  4  9  2  2  2  4  0  2  2
      5  2  6  6  2 10  4  2  2  5  4  4  9  4  4  4  4  4  4  6  4  4  4  2
      2  4  2  4 10  2  2  2  4  4  4  4  2  4  4  4  2  9  2  4  4  4  2  4
      4  2  2  9  2  2  9  6  4  2  4  2  2  2  2  2  2  4  4  4  4  2  4  4
      2  2  4  2  9  5 10  4  4  5  6  7  2  5  9  2  4  2  5  5  0  5  5  2
      2  2  2  2  2  2  2  2  2  4  2  2  2  2  4  4  9  4  2  4  2  2  0  6
      4  4  4  2  5 10  2  2  2  4  6  9  7  2  2  2  4  4  5  1  2  2  2  2
      2  2  4  2  2  7  4  6  2  2  5  2 10  9  2  5  4  2  4  4  3  4  4]
    # of episode: 18, avg score: -0.0079
      Actions: [ 2  0  9  2  4  1  4  4  2  2  9  2  2  9  4  2  6  2  5  4  2  5  5  4
      4  5  4  4  5  6  2  9  2  4  9  4  4  5  3  2  2  4  2  2  4  2  4  3
      7  2  2  2  2  2  4  2  2  2  2  0  2  5  2  4  2  5  4  2  5  2  2  5
      4  2  1  9  2  2  7  2  2  2  4  2  2  2  3  2  2  2  2  4  4  2  4  5
      5  2  2  2  2  2  5  2  4  3  2  4  9  2  2  2  2  2  4  2  2  0  2  2
      2  2  4  2  5  6  7  4  6  2  4  4  0  4  7  2  2  2  2  7  6  2  4  2
      2  5  5  4  2  4 10  2  9  4  4  4  2 10  5  2  2  3  6  4  2  7  4  4
      9  4  3  2  2  4  4  4  4  2  2  2  4  2  4  4  4  2  4  2  2  2  6  2
      2  2  4  2  4  4  4  5  2  2  5  2  2  4  2  9  2  4  4  2  5  4  4  2
      2  2  4  5  2  2  0  2  2  5  2  2  2  2  2  2  4  6  2  5  2  2  2  4
      2  9  5  5  2  2  2  0  2  4  4  4  2  2  4  2  4  2  4  2  2  2  4  4
      4  2  2  2  7  5  2  4  6  5  7  4  2  4  4  2  4  2  2  2  2  2  5]
    # of episode: 19, avg score: -0.2012
      Actions: [ 2  2  4  2  2  2  4  2  4  2  2  5  2  4  2  2  4  2  4  2  7  7  4  1
     10  2  4  4  6  2  0 10  5  4  2  2  0  2  2  4  4  2  4  4  4  2  2  4
      2  4  4  2  2  4  5  4  4  2  2  2  5  4  2  2  3  2  3  2  2  2  2  4
      2  4  4  4  4  2  4  5  5  4  2  3  2  4  2  5  2  2  3  4  6  4  2  4
     10  6  2  4  4  7  5  2  2  2  2  2  2  6  2  5  2  4  2  2  5  2  6  4
      2  2  6  4  2  9  2  2  0  2  2  2  7  2  2  5  2  4  2  2  4  4  2  6
      2  5  4  9  2  4  2  6  4  2  2  9  4  2  2  2  2  2  2  2  2  2  2  4
      4  5  2  2  2  5  2 10  4  4  4  2  2  2  2  3  2  2  4  2  2  2  5  4
      2  2  2  2  2  5  2  4  2  2  2  4  4  4  4  2  2  4  6  3  2  2  4  4
      2  1  4  2  2  7  4  4  2  2  2  4  2  2  4  2  2  4  2  2  4  2  4  2
      2  2  2  2  4  2  6  2 10  4  2  9  2  6  4  2  5  4  2  2  2  9  2  2
      2  4  2  2  4  5  2  4  6  2  4  2  5  2  4  7  2  2  2  4  4  2  5]
    # of episode: 20, avg score: -0.2451
      Actions: [ 2  2  2  1  2  4  5  5  4  2  6  4  2  4  4  4  4  2  0  4  2  2  4  4
      2  2  4  2  2  9  2  4  4  4  6  4  4  1  4  2  4  2  2  2  2  6  4  6
      2  4  2  4  2  1  5  2  4  4 10  2  4  2  2  4  9  2  2  2  2  8  6  6
      3  2  4  4  4  6  4  4  2  2  2  2  4  4  2  4  5  4  2  6  4  2  4  2
      4  4  2  4  4  5  9  2  5  2  2  2  4  2  2  2  2  5  4  2  6  2  2  2
      4  4  9  4  4  4  2  2  2  4  9  2  6  2  2  4  2  2  2  2  3  2  2  2
      4  4  2  6  2  4  2  6  0  9  2  2  5  2  2  2  4  2  5  0  4  2  4  2
      2  4  3  2  4  4  2  2  2  4  4  6  2  4  2  2  6  2  2  4  4  2  4  2
      2  2  4  4  5  2  4  2  2  5  2  6  2  9  2  2  2  2  6  2  2  2  2  2
      2  4  5  2  2  4  0  2  2  3  2  2  2  2  4  4  4  4  2  4  2  2  2  2
      3  2  2  2  2  6  2  5  2  4  4  4  2  9  4  2  5  4  2  2  6  2  2  2
      6  5  2  2  4  2  2  4  4  4  9  6  2  2  4  4  4  2  2  2  2  2  2]
    # of episode: 21, avg score: 0.0175
      Actions: [ 2  2  2  5  6  2  4  5 10  9  2  5  4  2  2  2  4  4  5  6  2  3  6  4
      2  2  4  4  4  6  2  3  1  3  5  2  4  4  6  2  4  4  9  2  4  0  4  5
      2  2  2  4  4  2  2  2  4  4  4  2  2  2  4  2  4  2  2  4  4  4  2  4
      5  4  4  4  2  6  4 10 10  4  7  4  4  2  2  2  2  6  2  4  4  4  6  2
      4  4  5  2  4  4  4  2 10  2  4  2  5  6  2  9  4  5  2  2  7  2  5  4
      2  5  5  5  4  2  6  2  2  4  2  4  4  4  2  4  4  4  4  4  2  9  4  3
      2  4  2  4  6  4  4  4  2  4  2  4  2  4  4  4  4  2  4  2  5  4  2  2
      4  2  5  2  4  2  2  2  4  5  2  2  2  4  6  4  4  7  5  2  4  4  2  4
      4  5  2  9  2  4  2  2  2  2  2  2  2  5  4  2  2  2  2  2  2  2  9  2
      2  2  2  5  5  2  2  2  9  5  2  2  2  4  5  0  3  4  6  2  2  4  2  2
      2  4  2  9  2  2  4  6  6  2  5  2  7  2  2  4  2  4  5  5  2  3  4  4
      4  0  4  4  2  2  2  5  4  4  2  2  2  4  2  2  4  2  4  2  4  2  2]
    # of episode: 22, avg score: 0.0278
      Actions: [ 2 10  4  4  6  4  4  4  2  2  2  4  2  2  5  4  2  4  2  2  2  2  4  3
      2  2  2  4  4  3  2  5  2 10  2  2  4  2  2  5  4  3  0  2  4  3  4  5
      2  4  4  4  4  5  2  5  2  4  2  2  2 10  2  2  2  5  3  4  2  4  4  2
      4  2  4  7  2  4  2  4  4  2  4  4  2  4  2  3  2  2  0  2  4  2  5  5
      2  4  2  4  4  4  4  2  4  4  9  3  4  5  5  9  6  2  4 10  2  5  4  4
      6  2  4  4  4  9  4  4  9  4  4  4  2  4  7  4  6  4  5  2  3  2  3  2
      2  4  4  2  2  1  4  4  2  2  6  2  4  4  5  2  9  2  2  9  4  2  2  2
      2  2  4  4  5  2  2  2  4  5  2  5  2  5  3  4  4  4  9  9  4  2  2  2
      9  2  2  4  2  4  4  6  2  2  2  9  2  2  2  2  4  2  4  2  7  2  2  2
      2  2  2  6  2  4  2  2  2  9  2  4  2  9  9  2  0  4  2  2  5  4  4  4
      4  2  2  2  6  6  2  2  2  5  4  2  9  4  2  2  4  2  5  1  4  2  4  2
      4  1  4  9  4  4  4  2  9  2  4  2  2  2  3  2  4  0  2  2  4  2  2]
    # of episode: 23, avg score: -0.0283
      Actions: [ 2  2  2  4  2  4  4  4  4  2  3  0  2  4  0  2  2  2  4  4  2  2  5  2
      2  2  2  2  2  2  2  4  2  2  2  4  4 10  4  4  4  6  4  4 10  4  4  2
      2  2  5 10  4  4  2  2  2  2  4  6  4  4  2  2  9  4  2  3  2  4  2  2
      2  2  9  2  2  2  2  2  2  2  2  4  2  2  5  2  2  2  2  2  4  4  7  5
      4  5  4  4  2  2  2  2  4  2  2  2  2  2  2  2  4  6  4  2  4  2  2  4
      2  4  2  2  3  2  2  5  2  2  2  4  4  2  2  5  2  4  2  2  4  4  4  2
      4  2  2  2  4  4  4  2  4  4  2  4  2  2  2  9  4  4  2  0  9  2  6  6
      4  2  4  6  4  4  2  2  4  2  0  4  2  0  1  4  2  2  2  2  2  2  4  4
      2  9  4  4  9  2  4  9  0  2  2  2  4  2  2  2  2  5  2  4  2  2  5  4
      4  5  2  3  2  2  2  5  2  4  5  6  2  3  4  2  2  2  2  2  2  2 10  2
      4  2  2  6  2  3  2  2  2  4  2  2  2  0  2  2  0  4  2  2  2  4  2  2
      2  2  2  2  2  4  2  2  2  7  2  5  2  4  6  2  5  2  2  4  4  2  2]
    # of episode: 24, avg score: -0.0729
      Actions: [4 6 2 5 2 5 6 2 2 2 4 6 3 4 6 2 5 7 2 2 2 2 2 7 4 4 2 4 2 2 2 2 2 2 2 9 2
     5 4 4 9 9 2 2 4 5 5 0 2 2 2 2 6 9 4 2 3 3 2 9 2 0 4 5 1 0 2 2 2 5 2 2 2 7
     2 7 2 2 4 2 2 2 2 4 2 2 2 2 3 2 5 2 2 4 2 2 4 0 3 2 6 2 2 9 5 2 5 2 5 0 7
     2 2 5 2 2 0 4 9 2 2 9 5 2 5 2 2 2 2 5 8 2 2 7 2 3 8 5 2 5 4 0 2 5 2 0 3 2
     5 2 5 2 4 8 8 2 0 2 3 2 2 2 2 9 5 2 8 2 4 5 8 5 2 8 2 7 2 9 6 7 2 9 2 5 2
     2 6 2 4 5 4 5 2 6 4 2 3 3 4 8 4 0 8 2 6 2 2 3 2 2 0 0 2 2 2 4 2 3 4 8 2 9
     5 2 9 3 7 4 2 2 2 2 9 3 2 0 2 8 2 2 2 2 2 4 2 2 3 2 2 2 3 5 8 3 4 9 5 8 9
     2 4 9 6 4 2 2 2 2 2 2 2 2 2 2 2 4 2 2 2 3 5 8 2 2 3 3 4]
    # of episode: 25, avg score: -0.1388
      Actions: [ 2  4  2  2  2  4  2  2  9  2  4  4  4  6  3  4  2  2  1  0  2  4  2  2
      4  5  4  3  2  2  4  3  7  4  2  5  2  2  2  2  2  2  4  2  2  2  4  4
      5  2  2  4  4  4  2  2  2  2  0  2  4  2  0  6  6  2  4  2  4  2  2  2
      2  2  4  4  2  2  4  2  0  0  1  2  5  2  5  0  2  4  5  5  4  0  4  2
      2  2  4  7  4  9  4  2  2  2  2  4  2  4  2  4  2  2  9  2  2  2  2  4
      2  5  2  5  0  4  2  5  4  2  4  2  2  2  4  5  5  2  2  0  2  4  4  5
      4  2  5  2  0  2  2  5  2  4  2  2  6  5  4  4  4  2  7  2  3  2  2  4
      4  4 10  5  4  4  5  4  2  4  4  2  2  5  2  9  2  4  4  5  4  2  2  4
      2  2  4  2  2  4  4 10  4  2  3  2  2  5  0  2  9  2  2  2  4  4  2  6
      4  2  0  2  4  2  2  2  0  4  4  7  4  4  2  2  2  4  0  6  2  4  5  2
      2  9  6  3  2  2  9  2  5  4  5  2  6  2  4  9  2  2  2  2  5  2  2  2
      2  4  3  5  2  9  4  4  2  2  2  5  2  2 10  4 10  5  2  2  5  4  2]
    # of episode: 26, avg score: 0.0028
      Actions: [ 4  4  2  2  2 10  5  4  4  2  2  2  9  9  2  2  5  2  2  2  2  4  4  2
      2  4 10  6  4 10  5  2  4  2  4  4  4  2  4  2  4  4  2  2  4  5  4  5
      4  4  4  2  6  2  5  4  5  2  2  2  5  2  4  7  4  5  4  0  2  6  2  2
     10  2  9  5  4  4  2  0  2  2  4  2  1  4  2  4  2  4  4  5  7  4  2  4
      7  2  4  0  2  5  2  4  2  7  2  2  2  3  4  2  4  4  2  2  6  2  4  2
      2  4  2  2  2  2  2  2  2  2  3  2  9  2  2  4  4  4  2  4  4  2  2  4
      2  2  4  2  7  2  4  4  2  4 10  2  4  2  4  5  2  4  2  2  4  2  4  5
      5  2  4  2  2  2  2  4  7  4  5  2  4  2  4  2  4  0  2  2  2  9  4  9
      2  4  4  4  4  4  5  0  2  9  2  5  2  0  2  4  2  2  5  2  5  4  6  9
      9  9  4  2  4  4  4  2  4  4  4  2  2  2  4  2  2  2  4  4  4  4  3  2
      5 10  2  2  5  9  5  4  2  2  2  2  4  4  5  4  6  4  2  2  4  9  2  4
      5  4  4  4  4  2  4  5  4  4  5  4  6  2  4  4  7  4  4  4  2  2  2]
    # of episode: 27, avg score: 0.1519
      Actions: [ 2  2  4  4  4  1  4  2  2  5  2  4  5  4  2  6  9  4  4  4  2  4  4  4
      4  2  2  4  2  6  5  2  2  2  2  2  4  2  4  6  4  4  2  2  2  4  2  6
      2  5  4  2  4  4  2  4  5  5  6  2  2  4  2  4  5  0  2  2  2  2  4  2
      2  4  5  5  4  4  2  4  4  2  5  2  2  2  5  2  4  2  5  4  2  4  2  4
      4  5  4  4  2  2  2  4  2  2  2  2  2  4  2  4  5  2  5  4  4  2  2  4
      4  2  6  2  4  4  4  4  2  5  2  9  4  4  2  2  6  4  7  4  2  2  4  2
      2  9  2  5  2  2  5  5  2  2  9  2  2  2  2  2  2  4  2  2  2  2  2  6
      2  2  2  2  4  2 10  2  2  2  2  2  2  2  2  4  6  2  2  1  2  2  7  0
      4  4  2  4  2  4  5  5  2  4  2  4  2  2  4  2  2  4  2  2  6  5  5  2
      2  2  2  4  2  2  2  4  4  5  5  4  2  2  2 10  5  4  2  2  5  2  2  2
      2  4  3  6  4  2  2  5  2  4  4  5  4  5  2  2  2  2  4  2  6  5  4  2
      4  2  4  2  2  1  2  4  4  2  3  2  5  2  4  5  2  2  4  2  6  9  4]
    # of episode: 28, avg score: 0.0663
      Actions: [ 2  2  4  4  2  4  4  4  4  4  2  4  2  2  2  4  2  2  2  2  4  4  2  6
      4  2  2  4  5  4  6  6  4  2  4  5  4  2  2  4  2  6  4  2  7  2  9  2
      2  9  4  4  4  3  3  2  2  5  2  2  4  2  4  4  2  5  4  4 10  2  5  3
      4  4  4  4  5  2  2  4  4  2  2  4  2  4  4  2  2  2  4  2  2  5  3  2
      4  4  2  5  2  2  7  5  2  3  2  6  2  4  7  2  4  5  2  4  2  5  4  4
     10  2  2  2  2  2  9  2  4  2  6  2  2  4  4  2  4  6  2  2  2  9  5  2
      4  4  6  4  2  6  4  2  2  6  4  4  2  2  5  2  2  4  9  4  4  2  2  4
      2  4  6  6  6  5  4  2  2  4  2  4  4  2  3  4  6  2  2  9  2  2  0  7
      2  4  2  2  4  2  4  5  2  4  6  2  2  2  4  2  2  2  6  2  2  2  2  2
      2  2  4  4  2  2  4  2  4  6  4  2  0  4  7  2  2  2  2  4  4  2  2  4
      5  2  9  9  2  2  2  2  4  2  2  4  2  2  4  7  2  2  6  4  2  2  4  2
      2  4  2  4  2  2  6  2  2  2  4  5  5  2  4  7  0  4  2  4  2  4  2]


    /home/jeffrey/anaconda3/envs/RL/lib/python3.7/site-packages/torch/nn/_reduction.py:49: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
      warnings.warn(warning.format(ret))


    # of episode: 29, avg score: 0.1018
      Actions: [ 4  2  5  2  4  6  2  4  4  2  4  2  4  4  2  2  6  2  6  2  5  5  5  4
      2  4  2  4  4  2  4  2  6  4  2  4  2  2  2  2  4  4  2  2  4  1  2  2
      2  4  9  4  7  2  2  4  2  2  9  9  5  2  2  4  5  2  4  4  2  2  4  2
      4  4  2  4  2  5  2  2  2  6  9  4  5  5  5  9  1  5  5  5  9  9  9  9
      9  9  9  5  9  9  9  9  9  9  9  9  9  9  9  1  9  9  3  4  9  7  9  4
      7  7  1  6  9  1  9  2  4  2  9  1  4  9  9  6  2 10  5  7  9  9  9  9
      9  1  9  5  5  9  5  9  9  5  1  9  9  9  9  1  7  9  7  1  1  4  1  1
      1  1  1  5  5  0  1  1  8  1  3  7  7  0  1  7  1  0  6  7  7 10  1  6
      7  1  5  1  6  9  1  7  1  9  2  2  3  2  2  4  1  2  1  9  2  4  2  6
      4  2  1  4  2  2  7  0 10  7  2  4  9  1  2  6  1  4  5  1  4  4  2  9
      5  4  2  6  9  7  1  1  7  4  9  2  9  4  9  4  2  1  9  2  2  2  2  2
      2  9  1  2  9  9  5  9  9  2  1  9  2  3  2  6  7  9  6  3  7  7  0]
    # of episode: 30, avg score: -0.1304
      Actions: [ 1  9  1  4  1  1  1  1  5  3  1  7  3 10  6  0  1  1  6 10  4  1  1  4
     10  6  7  1  1  6  1  4  2  4  6  1  7  9  5 10  2  1  1  1  7  5  3 10
      9  3  1  1  6  1  1  3  6  3  1  5  2  4  1  2  3  9  6  6  9  4  9  9
      9  9 10  6  9  3  7  1  4  9  3  1  0  3  9  9  3  3  3  9  2  9  9  1
      9  3  3  6  9  2  9  3  6  5  6  9  2  6  2  9  5  5  2  1  9  2  1  6
      2  2  9  2  3  4  9  9  1  2  3 10  1  1  9  9  1  1  6  2  2  1  9  7
      5  1  5  3  9  0  3  4  4  2  4  9  1  3  0 10  1  0  3  7  0  6  9  9
     10  0  1  0 10  6  0  3 10  1  6 10  5 10 10  0  0  0  3 10  5  7  2  2
      4 10  3 10  4 10 10  2 10 10  3  4  2 10  2 10  2  3  2  0 10  2  3 10
      3 10  1  2  3 10  3  0  1  3  3  3 10 10  3 10  0  9 10  3 10  8 10  3
      3  9  3  3 10  3 10  6  9  4  5  2  3  2  9  2  4  4  1  2  5  4  1  4
      4 10  5  4  5  5  5  4 10  2  4  4  5  2 10  4  2  2  1  2  5  4  4]



    ---------------------------------------------------------------------------

    KeyboardInterrupt                         Traceback (most recent call last)

    <ipython-input-4-839d38f762a4> in <module>
         31             action = 2 * n_action_intervals
         32         actions.append(action)
    ---> 33         agent.step(state, action, reward, next_state, done)
         34         state = next_state
         35         if done:


    ~/Binanace_trading_simulation/agent/Attention/DQNTradingAgent/dqn_agent.py in step(self, state, action, reward, next_state, done)
        142             # If enough samples are available in memory, get random subset and learn
        143             if len(self.memory) >= self.start_since:
    --> 144                 experiences, target_discount, is_weights, indices = self.memory.sample(self.beta)
        145                 new_priorities = self.learn(experiences, is_weights, target_discount)
        146                 self.memory.update_priorities(indices, new_priorities)


    ~/Binanace_trading_simulation/agent/Attention/DQNTradingAgent/replay_buffer.py in sample(self, beta)
        108         experiences = tuple(zip(*[self.memory[i] for i in indices if self.memory[i] is not None]))
        109 
    --> 110         first_states = torch.tensor([e[0] for e in experiences[0]], dtype=torch.float, device=device)
        111         actions      = torch.tensor([e[1] for e in experiences[0]], dtype=torch.long, device=device)
        112         rewards      = torch.tensor(


    KeyboardInterrupt: 

